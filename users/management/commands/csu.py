from django.core.management import BaseCommand

from users.models import User


class Command(BaseCommand):
    """
    Команда для создания суперпользователя через командную строку.

    Эта команда используется для создания суперпользователя с правами администратора,
    который может управлять приложением через админ-панель. Это полезно для первоначальной настройки
    системы, особенно при создании первого администратора.

    Пользователь будет создан с следующими данными:
    - email: admin@localhost
    - password: 12345
    - first_name: Admin
    - is_superuser: True (дает полные права)
    - is_active: True (активирован)
    - is_staff: True (имеет доступ к админке)
    """

    def handle(self, *args, **kwargs):
        """
        Основная логика команды.

        Создает пользователя с правами суперпользователя, задает пароль и сохраняет пользователя
        в базе данных. Если пользователь с таким email уже существует, будет создан новый.
        """
        # Создаем объект пользователя с базовыми параметрами
        user = User.objects.create(
            email="admin@localhost",
            password="12345",  # Пароль будет изменен на более безопасный позже
            first_name="Admin",
            is_superuser=True,  # Устанавливаем флаг суперпользователя
            is_active=True,  # Устанавливаем, что пользователь активен
            is_staff=True,  # Даём доступ к административной панели
        )

        # Устанавливаем более безопасный хешированный пароль
        user.set_password("12345")

        # Сохраняем пользователя в базе данных
        user.save()
